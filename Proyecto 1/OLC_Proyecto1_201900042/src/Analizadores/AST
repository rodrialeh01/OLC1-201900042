package analizadores; 
import Clases.ErrorLenguaje;
import java_cup.runtime.*;
import Structures.Instrucciones.Comentarios;
import Structures.Instrucciones.Declaracion;
import Structures.Instrucciones.Instruccion;
import Structures.Instrucciones.Operacion;
import Structures.Instrucciones.Si;
import Structures.Instrucciones.Main;
import Structures.Instrucciones.Asignacion;
import Structures.Instrucciones.Case;
import Structures.Instrucciones.SeleccionMultiple;
import Structures.Instrucciones.Para;
import Structures.Instrucciones.Mientras;
import Structures.Instrucciones.Repetir;
import Structures.Instrucciones.Impresion;
import Structures.Instrucciones.Ejecutar;
import Structures.Instrucciones.Parametro;
import Structures.Instrucciones.Funciones;
import Structures.Instrucciones.Metodo;
import Structures.Instrucciones.Retornar;
import java.util.LinkedList;
import Structures.Nodo;
import Structures.Arbol;
import Structures.Produccion;


parser code 
{:
    /**
    *Listas
    **/
    public LinkedList<ErrorLenguaje> ErroresSintacticos = new LinkedList<ErrorLenguaje>();
    public LinkedList<Instruccion> TraduccionGo = new LinkedList<Instruccion>();
    public LinkedList<Instruccion> TraduccionPy = new LinkedList<Instruccion>();
    public String mensajeError = ""; 
    /**
     * Método al que se llama automáticamente ante algún error sintactico.
     **/ 
    public void syntax_error(Symbol s){
        
        ErroresSintacticos.add(new ErrorLenguaje("Sintáctico","Carácter no esperado: "+s.value.toString(),s.right,s.left));
        mensajeError += "Error Sintáctico en la Línea " + (s.left) + " Columna "+s.right+ ". No se esperaba este componente: " +s.value+".\n";
        System.out.println("Error Sintáctico en la Línea " + (s.left) +
        " Columna "+s.right+ ". No se esperaba este componente: " +s.value+"."); 
    } 

    /**
     * Método al que se llama automáticamente ante algún error sintáctico 
     * en el que ya no es posible una recuperación de errores.
     **/ 
    public void unrecovered_syntax_error(Symbol s) throws java.lang.Exception{ 
        ErroresSintacticos.add(new ErrorLenguaje("Sintáctico","Carácter no esperado: "+s.value.toString(),s.right,s.left));
        mensajeError += "Error síntactico irrecuperable en la Línea " + (s.left)+ " Columna "+s.right+". Componente " + s.value + " no reconocido.\n";
        System.out.println("Error síntactico irrecuperable en la Línea " + 
        (s.left)+ " Columna "+s.right+". Componente " + s.value + 
        " no reconocido."); 
    }
:} 

terminal String RINICIO,RFIN,RMETODO,RFINMETODO,RFUNCION,RFINFUNCION,RCONPARAMETROS,RRETORNAR,RINGRESAR,RCOMO,RCONVALOR,RSI,RENTONCES,ROSI,RDELOCONTRARIO,RFINSI,RSEGUN,RHACER,RFINSEGUN;
terminal String COMENTARIOL,COMENTARIOML,RPARA,RHASTA,RCONINCREMENTAL,RFINPARA,RMIENTRAS,RFINMIENTRAS,RREPETIR,RHASTAQUE,REJECUTAR,RIMPRIMIR,RIMPRIMIRNL;
terminal String IDENTIFICADOR;
terminal String ENTERO;
terminal String CARASCCI;
terminal String CADENA;
terminal String CARACTER;
terminal String DECIMAL;
terminal String SUMA,RESTA,MULTIPLICACION,DIVIDIR,MODU,POTENCIA;
terminal String RMAYOR,RMENOR,RMAYOROIGUAL,RMENOROIGUAL,RESIGUAL,RESDIFERENTE,ROR,RAND,RNOT;
terminal String RNUMERO,RCADENA,RBOOLEAN,RCARACTER;
terminal String RVERDADERO,RFALSO;
terminal String PARIZQ,PARDER,INTABRE,INTCIERRA,FLECHA,PTCOMA,COMA,CORIZQ,CORDER;

non terminal Produccion INICIO;
non terminal Produccion INSTRUCCIONES;
non terminal Produccion DECLARACION;
non terminal Produccion LISTA_IDENTIFICADORES;
non terminal Produccion ASIGNACION;
non terminal Produccion EXPRESION;
non terminal Produccion TIPODATO;
non terminal Produccion FUNCION;
non terminal Produccion METODO;
non terminal Produccion GLOBAL;
non terminal Produccion LISTA_PARAMETROS;
non terminal Produccion ENTORNO_LOCAL;
non terminal Produccion CONDICIONAL_SI;
non terminal Produccion CONDICION;
non terminal Produccion LOCAL;
non terminal Produccion LISTA_OSI;
non terminal Produccion SELECCION_MULTIPLE;
non terminal Produccion LISTA_VALORENTONCES;
non terminal Produccion CICLO_PARA;
non terminal Produccion CICLO_MIENTRAS;
non terminal Produccion CICLO_REPETIR;
non terminal Produccion EJECUTAR;
non terminal Produccion IMPRESION;
non terminal Produccion IMPRESION_CONSALTO;
non terminal Produccion ALGORITMO;
non terminal Produccion MAIN;
non terminal Produccion COMENTARIOS;
non terminal Produccion COMENTARIO;
non terminal Produccion INSERCION_PARAMETROS;
non terminal Produccion EJECUTAR_2;
non terminal Produccion RELACIONAL;
non terminal Produccion FYM;
non terminal Produccion AGRUPACION;

precedence left SUMA,RESTA;
precedence left MULTIPLICACION,DIVIDIR;
precedence left POTENCIA,MODU;

//-------------------------------------------GRAMATICA SINTACTICA-------------------------------------------------
start with INICIO; 

INICIO::=INSTRUCCIONES                                                                                  {:
                                                                                                            parser.AST=a.getInstructions();
                                                                                                            Node NODORAIZ = new Node("INICIO"); NODERAIZ.addSon(a.getNodo());
                                                                                                            parser.arbol=new Arbol(NODORAIZ);
                                                                                                        :}                                                                           
;
INSTRUCCIONES::=MAIN                                                                                    {:
                                                                                                            RESULT=new Production(new Node("Instrucciones"), a.getInstructions());
                                                                                                            RESULT.addIns(b.getIns());
                                                                                                            RESULT.addSon(a);
                                                                                                            RESULT.addSon(b);
                                                                                                        :}
               |COMENTARIOS                                                                           
               |error
;
MAIN::=RINICIO ALGORITMO:a RFIN                                                                         {:
                                                                                                            
                                                                                                        :}                                                         
      |RINICIO RFIN                                                                                     {:
                                                                                                            
                                                                                                        :}
;
COMENTARIOS::=COMENTARIOS COMENTARIO
             |COMENTARIO
;
COMENTARIO::=COMENTARIOL:a                                                                              {:  
                                                                                                            
                                                                                                        :}
            |COMENTARIOML:a                                                                             {:  
                                                                                                            
                                                                                                        :}
;
ALGORITMO::=ALGORITMO:a GLOBAL:b                                                                        {:  
                                                                                                            
                                                                                                        :}                                                                                     
           |GLOBAL:a                                                                                    {:  
                                                                                                            
                                                                                                        :}
;
GLOBAL::= ENTORNO_LOCAL:a                                                                               {:  
                                                                                                            
                                                                                                            
                                                                                                        :}
         |FYM:a                                                                                         {:  
                                                                                                            
                                                                                                        :}
;
FYM::=FUNCION:a                                                                                         {:  
                                                                                                           
                                                                                                        :}
     |METODO:a                                                                                          {:  
                                                                                                            
                                                                                                        :}
;
DECLARACION::=RINGRESAR LISTA_IDENTIFICADORES:l RCOMO TIPODATO:b RCONVALOR CONDICION:e PTCOMA           {:  
                                                                                                            
                                                                                                        :}
;
LISTA_IDENTIFICADORES::=LISTA_IDENTIFICADORES:a COMA IDENTIFICADOR:b                                    {:  
                                                                                                            
                                                                                                        :} 
                       |IDENTIFICADOR:a                                                                 {:  
                                                                                                            
                                                                                                        :}
;
EXPRESION::=ENTERO:a                                                                                    {:  
                                                                                                            
                                                                                                        :}
            |DECIMAL:a                                                                                  {:  
                                                                                                            
                                                                                                        :}
            |CADENA:a                                                                                   {:  
                                                                                                            
                                                                                                        :}
            |CARACTER:a                                                                                 {:  
                                                                                                            
                                                                                                        :}
            |CARASCCI:a                                                                                 {:  
                                                                                                            
                                                                                                        :}
            |RVERDADERO:a                                                                               {:  
                                                                                                            
                                                                                                        :}
            |RFALSO:a                                                                                   {:  
                                                                                                            
                                                                                                        :}
            |IDENTIFICADOR:a                                                                            {:  
                                                                                                            
                                                                                                        :}
            |RESTA EXPRESION:a                                                                          {:  
                                                                                                            
                                                                                                        :}
            |EXPRESION:a SUMA EXPRESION:b                                                               {:  
                                                                                                            
                                                                                                        :} 
            |EXPRESION:a RESTA EXPRESION:b                                                              {:  
                                                                                                            
                                                                                                        :} 
            |EXPRESION:a MULTIPLICACION EXPRESION:b                                                     {:  
                                                                                                            
                                                                                                        :} 
            |EXPRESION:a DIVIDIR EXPRESION:b                                                            {:  
                                                                                                            
                                                                                                        :}        
            |EXPRESION:a POTENCIA CORIZQ EXPRESION:b CORDER                                             {:  
                                                                                                            
                                                                                                        :} 
            |EXPRESION:a MODU EXPRESION:b                                                               {:  
                                                                                                            
                                                                                                        :}
            |AGRUPACION:a                                                                               {:  
                                                                                                            
                                                                                                        :}  
            |EJECUTAR_2:a                                                                               {:  
                                                                                                            
                                                                                                        :}
;
RELACIONAL::=EXPRESION:a                                                                                {:  
                                                                                                            
                                                                                                        :}
           |EXPRESION:a RMAYOR EXPRESION:b                                                              {:  
                                                                                                            
                                                                                                        :}
           |EXPRESION:a RMENOR EXPRESION:b                                                              {:  
                                                                                                            
                                                                                                        :}
           |EXPRESION:a RMAYOROIGUAL EXPRESION:b                                                        {:  
                                                                                                            
                                                                                                        :}
           |EXPRESION:a RMENOROIGUAL EXPRESION:b                                                        {:  
                                                                                                            
                                                                                                        :}
           |EXPRESION:a RESIGUAL EXPRESION:b                                                            {:  
                                                                                                            
                                                                                                        :}
           |EXPRESION:a RESDIFERENTE EXPRESION:b                                                        {:  
                                                                                                            
                                                                                                        :}
;
CONDICION::=RELACIONAL:a ROR RELACIONAL:b                                                               {:  
                                                                                                            
                                                                                                        :}
           |RELACIONAL:a RAND RELACIONAL:b                                                              {:  
                                                                                                            
                                                                                                        :}
           |RNOT RELACIONAL:a                                                                           {:  
                                                                                                            
                                                                                                        :}
           |RELACIONAL:a                                                                                {:  
                                                                                                            
                                                                                                        :}
;
AGRUPACION::=PARIZQ CONDICION:a PARDER                                                                 {:  
                                                                                                            
                                                                                                        :}  
;
ASIGNACION::=LISTA_IDENTIFICADORES:l FLECHA EXPRESION:e PTCOMA                                          {:  
                                                                                                            
                                                                                                        :}
;
FUNCION::=RFUNCION IDENTIFICADOR:a TIPODATO:b LOCAL:c RRETORNAR CONDICION:d PTCOMA RFINFUNCION          {:  
                                                                                                           
                                                                                                        :}
         |RFUNCION IDENTIFICADOR:a TIPODATO:b RRETORNAR CONDICION:c PTCOMA RFINFUNCION                  {:  
                                                                                                            
                                                                                                        :}
         |RFUNCION IDENTIFICADOR:a TIPODATO:b RCONPARAMETROS PARIZQ LISTA_PARAMETROS:l PARDER LOCAL:c RRETORNAR CONDICION:d PTCOMA RFINFUNCION{:  
                                                                                                            
                                                                                                        :}
         |RFUNCION IDENTIFICADOR:a TIPODATO:b RCONPARAMETROS PARIZQ LISTA_PARAMETROS:l PARDER RRETORNAR CONDICION:c PTCOMA RFINFUNCION{:  
                                                                                                            
                                                                                                        :}
;
METODO::=RMETODO IDENTIFICADOR:a LOCAL:b RFINMETODO                                                     {:  
                                                                                                            
                                                                                                        :}
        |RMETODO IDENTIFICADOR:a RFINMETODO                                                             {:  
                                                                                                            
                                                                                                        :}
        |RMETODO IDENTIFICADOR:a RCONPARAMETROS PARIZQ LISTA_PARAMETROS:l PARDER LOCAL:b RFINMETODO     {:  
                                                                                                            
                                                                                                        :}
        |RMETODO IDENTIFICADOR:a RCONPARAMETROS PARIZQ LISTA_PARAMETROS:l PARDER RFINMETODO             {:  
                                                                                                            
                                                                                                        :}
;
LISTA_PARAMETROS::=LISTA_PARAMETROS:l COMA IDENTIFICADOR:a TIPODATO:b                                   {:  
                                                                                                           
                                                                                                        :}
                  |IDENTIFICADOR:a TIPODATO:b                                                           {:  
                                                                                                            
                                                                                                        :} 
;
TIPODATO::=RNUMERO:a                                                                                    {:  
                                                                                                            
                                                                                                        :} 
          |RCADENA:a                                                                                    {:  
                                                                                                            
                                                                                                        :} 
          |RBOOLEAN:a                                                                                   {:  
                                                                                                            
                                                                                                        :} 
          |RCARACTER:a                                                                                  {:  
                                                                                                            
                                                                                                        :} 
;
LOCAL::=LOCAL:a ENTORNO_LOCAL:b                                                                         {:  
                                                                                                            
                                                                                                        :}  
       |ENTORNO_LOCAL:a                                                                                 {:  
                                                                                                            
                                                                                                        :} 
;
ENTORNO_LOCAL::=ASIGNACION:a                                                                            {:  
                                                                                                           
                                                                                                        :}
               |DECLARACION:a                                                                           {:  
                                                                                                            
                                                                                                        :}
               |CONDICIONAL_SI:a                                                                        {:  
                                                                                                            
                                                                                                        :}
               |SELECCION_MULTIPLE:a                                                                    {:  
                                                                                                            
                                                                                                        :} 
               |CICLO_PARA:a                                                                            {:  
                                                                                                            
                                                                                                        :}
               |CICLO_MIENTRAS:a                                                                        {:  
                                                                                                            
                                                                                                        :}
               |CICLO_REPETIR:a                                                                         {:  
                                                                                                            
                                                                                                        :}
               |EJECUTAR:a                                                                              {:  
                                                                                                            
                                                                                                        :}
               |IMPRESION:a                                                                             {:  
                                                                                                            
                                                                                                        :}
               |IMPRESION_CONSALTO:a                                                                    {:  
                                                                                                            
                                                                                                        :}
               |COMENTARIOL:a                                                                           {:  
                                                                                                            
                                                                                                        :}
               |COMENTARIOML:a                                                                          {:  
                                                                                                            
                                                                                                        :}
;
CONDICIONAL_SI::=RSI CONDICION:a RENTONCES LOCAL:b RFINSI                                               {:  
                                                                                                            
                                                                                                        :}                                
                |RSI CONDICION:a RENTONCES LOCAL:b LISTA_OSI:l RFINSI                                   {:  
                                                                                                            
                                                                                                        :}     
                |RSI CONDICION:a RENTONCES LOCAL:b LISTA_OSI:l RDELOCONTRARIO LOCAL:c RFINSI            {:  
                                                                                                            
                                                                                                        :}
                |RSI CONDICION:a RENTONCES LOCAL:b RDELOCONTRARIO LOCAL:c RFINSI                        {:  
                                                                                                            
                                                                                                        :}
;
LISTA_OSI::=LISTA_OSI:l ROSI CONDICION:c RENTONCES LOCAL:d                                              {:  
                                                                                                            
                                                                                                        :} 
            |ROSI CONDICION:e RENTONCES LOCAL:f                                                         {:  
                                                                                                            
                                                                                                        :}
;
SELECCION_MULTIPLE::=RSEGUN EXPRESION:a RHACER LISTA_VALORENTONCES:l RFINSEGUN                          {:  
                                                                                                            
                                                                                                        :}
                    |RSEGUN EXPRESION:a RHACER LISTA_VALORENTONCES:l RDELOCONTRARIO RENTONCES LOCAL:b RFINSEGUN{:  
                                                                                                            
                                                                                                        :} 
;
LISTA_VALORENTONCES::=LISTA_VALORENTONCES:l INTABRE EXPRESION:e INTCIERRA RENTONCES LOCAL:a             {:  
                                                                                                            
                                                                                                        :}
                     |INTABRE EXPRESION:e INTCIERRA RENTONCES LOCAL:a                                   {:  
                                                                                                            
                                                                                                        :}
;
CICLO_PARA::=RPARA IDENTIFICADOR:a FLECHA EXPRESION:b RHASTA EXPRESION:c RHACER LOCAL:d RFINPARA        {:  
                                                                                                            
                                                                                                        :}
            |RPARA IDENTIFICADOR:a FLECHA EXPRESION:b RHASTA EXPRESION:c RHACER RFINPARA                {:  
                                                                                                            
                                                                                                        :}
            |RPARA IDENTIFICADOR:a FLECHA EXPRESION:b RHASTA EXPRESION:c RCONINCREMENTAL EXPRESION:d RHACER LOCAL:e RFINPARA {:  
                                                                                                            
                                                                                                        :}
            |RPARA IDENTIFICADOR:a FLECHA EXPRESION:b RHASTA EXPRESION:c RCONINCREMENTAL EXPRESION:d RHACER RFINPARA {:  
                                                                                                            
                                                                                                        :}
;
CICLO_MIENTRAS::=RMIENTRAS CONDICION:a RHACER LOCAL:b RFINMIENTRAS                                      {:  
                                                                                                            
                                                                                                        :}
                |RMIENTRAS CONDICION:a RHACER RFINMIENTRAS                                              {:  
                                                                                                            
                                                                                                        :}
;
CICLO_REPETIR::=RREPETIR LOCAL:a RHASTAQUE CONDICION:b                                                  {:  
                                                                                                            
                                                                                                        :}
               |RREPETIR RHASTAQUE CONDICION:a                                                          {:  
                                                                                                            
                                                                                                        :}
;
EJECUTAR::=REJECUTAR IDENTIFICADOR:a PARIZQ PARDER PTCOMA                                               {:  
                                                                                                            
                                                                                                        :}
           |REJECUTAR IDENTIFICADOR:a PARIZQ INSERCION_PARAMETROS:l PARDER PTCOMA                       {:  
                                                                                                            
                                                                                                        :}
;
EJECUTAR_2::=REJECUTAR IDENTIFICADOR:a PARIZQ PARDER                                                    {:  
                                                                                                            
                                                                                                        :}
            |REJECUTAR IDENTIFICADOR:a PARIZQ INSERCION_PARAMETROS:l PARDER                             {:  
                                                                                                            
                                                                                                        :}
;
INSERCION_PARAMETROS::=INSERCION_PARAMETROS:l COMA EXPRESION:e                                          {:  
                                                                                                            
                                                                                                        :}
                      |EXPRESION:e                                                                      {:  
                                                                                                            
                                                                                                        :}
;
IMPRESION::=RIMPRIMIR EXPRESION:a PTCOMA                                                                {:  
                                                                                                            
                                                                                                        :}
;
IMPRESION_CONSALTO::= RIMPRIMIRNL EXPRESION:a PTCOMA                                                    {:  
                                                                                                            
                                                                                                        :}
;
